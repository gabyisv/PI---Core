<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./styles/style.css" />
  <link rel="stylesheet" type="text/css" href="\Users\PICHAU\OneDrive\Desktop\telaFunc.css">
   <script
      src="https://kit.fontawesome.com/eebdb6e4f5.js"
      crossorigin="anonymous"
    ></script>
</head>

<body onload="tempoResposta(), funcionariosCamara()">

  
    <nav class="menu-nav">
      <div class="logo-nav-lateral">
        <a href="./index.html"><img src="./docs/Logo-Monarex.png" alt="logo" /></a>
        <div class="menu-container">
        <ul>
          <li>
            <a href="./dashMes.html"><i class="fa-solid fa-table fa-lg"></i>Mensal</a>
          </li>
          <li>
            <a href="./dashDiaria.html"><i class="fa-solid fa-table-columns fa-lg"></i>Diário</a>
          </li>
          <li>
            <a href="#"><i class="fa-solid fa-users fa-lg"></i>Funcionários</a>
          </li>
          <li>
            <a href="./sensores.html"><i class="fa-solid fa-circle fa-lg"></i>Sensores</a>
          </li>
          <li>
            <a href="https://monarex.atlassian.net/servicedesk/customer/portal/1/group/-1"><i class="fa-solid fa-angles-up"></i>Central de Atendimento</a>
          </li>
          </li>
          <li id="liSuporte">
          </li>
          <li id="liJira">
          </li>
        </ul>
        </div>
      </div>

    <div class="sair-nav">
      <a onclick="sair()">Sair</a>
      <img src="./docs/exit-icon.png" alt="sair" />
    </div>
  </nav>

  <div class="cabecalho-mensal" style="margin-left: 245px; margin-right: 10px;">
    <h1>Funcionários</h1>
    <div class="imagem-cabecalho">
      <i class="fa-solid fa-bell"></i>
      <a href="./perf.html"><img src="./docs/fernando-brandao-icon.jpg" alt="" /></a>
    </div>
  </div>

  <div class="container_func">
    
    <div class="container-func-features">
      <div class="KPIs">
      <div class="ativos">
        <h1 id="funcAtivos"></h1>
        <span>Funcionários ativos</span>
      </div>
      <div class="Temp_resposta">
        <h1 id="tempoMedio"></h1>
        <span>Tempo de resposta médio</span>
      </div>
      <div class="incidentes">
        <h1 id="totalIncidentes"></h1>
        <span>Incidentes resolvidos</span>
      </div>
      </div>
      <div class="add">
        <strong>Adicionar funcionário</strong><br>
        <span id="add-text"> ID
        </span><br>
        <input type="text" id="input_addFuncionario"><br>
        <div class="icon-style">
        <button  onclick="adicionar()"><span><i class="fa-solid fa-circle-plus"></i>Adicionar<span></button>
      </div>
      </div>
    </div>
    <div class="container2">
      <input type="text" id="input_busca" placeholder="     Buscar...">
      <select id="Cargos">
        <option>Todos os cargos</option>
      </select>
    </div>
    <div class="container-table-func">
    <table class="tabela-funcionarios">
      <thead>
        <tr>
              <th>Nome</th>
              <th>Cargo</th>
              <th>Câmara</th>
              <th>Contato </th>
        </tr>
      </thead>
          <tbody id="funcionarioCamara">
            <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
            </tr>
      
          </tbody>
    </table>
    </div> <div class="final">
      <div id="final2">
        <button onclick="excluir()"><span><i class="fa-solid fa-trash"></i>Excluir</span></button>

      </div>
    </div>
  </div>

</body>

</html>

<script>

  

    function tempoResposta(){



      const permisaoSuporte = sessionStorage.getItem('SUPORTE');
      const liSuporte = document.getElementById('liSuporte');

      if(permisaoSuporte == 'true'){

      liSuporte.innerHTML = `<a href="./bobIA.html"><i class="fa-solid fa-headset"></i>Suporte</a>`
      liJira.innerHTML = `<a href="https://vinimendesdasilvaa.atlassian.net/jira/software/projects/KAN/list"><i class="fa-solid fa-bars-progress"></i></i>Jira</a>`
    }

      fetch('kpi/tempoResposta/',{
        method: 'POST',
        headers: {
          'Content-type':'application/json',
        },
        body: JSON.stringify({
        idEmpresaServer: sessionStorage.ID_EMPRESA
      })
    }).then(function (response){
      console.log(response)
      if(response.ok){
        
        response.json().then((json) =>{

          funcAtivos.innerHTML= json[0].FuncAtivos;
          totalIncidentes.innerHTML= json[0].Incidentes;
          tempoMedio.innerHTML = json[0].Media;
          
        })
      }
    })
    }

    function funcionariosCamara(){
        
      fetch('usuarios/camaraUsuarios',{
        method: 'POST',
        headers: {
          'Content-type':'application/json',
        },
        body: JSON.stringify({
        idEmpresaServer: sessionStorage.ID_EMPRESA
      })
    }).then(function (response){
      console.log(response)
      if(response.ok){

          

        var tbody = document.getElementById("funcionarioCamara");

          tbody.innerHTML = "";

response.json().then(function (json) {

          for (let i = 0; i < json.length; i++) {
              var usuario = json[i];

              var tr = document.createElement("tr");

              tr.innerHTML = `
              <td> ${usuario.Nome} </td>
              <td> ${usuario.Cargo} </td>
              <td> ${usuario.Camara} </td>
              <td> ${usuario.Contato} </td>
              `;

        tbody.appendChild(tr);
      }
});
    }
    
    })
  
}

function sair(){
          
          sessionStorage.clear();
          window.location.href ='../index.html'
        }


</script>